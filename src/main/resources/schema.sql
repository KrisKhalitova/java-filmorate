DROP TABLE IF EXISTS users CASCADE;
DROP TABLE IF EXISTS friendship CASCADE;
DROP TABLE IF EXISTS films CASCADE;
DROP TABLE IF EXISTS likes CASCADE;
DROP TABLE IF EXISTS genre CASCADE;
DROP TABLE IF EXISTS rating_mpa CASCADE;
DROP TABLE IF EXISTS film_genre CASCADE;

CREATE TABLE IF NOT EXISTS rating_mpa (
  rating_id LONG NOT NULL PRIMARY KEY AUTO_INCREMENT,
  name VARCHAR(32) NOT NULL
);

CREATE TABLE IF NOT EXISTS genres (
  genres_id LONG PRIMARY KEY,
  name varchar(32) UNIQUE NOT NULL
);

CREATE TABLE IF NOT EXISTS films (
  id LONG GENERATED BY DEFAULT AS IDENTITY PRIMARY KEY,
  name VARCHAR(64) NOT NULL,
  description VARCHAR(200) NOT NULL,
  release_date DATE NOT NULL,
  duration INTEGER NOT NULL,
  rating_id INTEGER REFERENCES rating_mpa(rating_id)
);

CREATE TABLE IF NOT EXISTS film_genre (
  film_id LONG REFERENCES films(id) NOT NULL,
  genre_id LONG REFERENCES genres(genres_id) NOT NULL
  );

CREATE TABLE IF NOT EXISTS users (
  id LONG GENERATED BY DEFAULT AS IDENTITY PRIMARY KEY,
  name VARCHAR(32) NOT NULL,
  email VARCHAR(64) NOT NULL,
  login VARCHAR(64) NOT NULL,
  birthday DATE
);

CREATE TABLE IF NOT EXISTS friendship (
  user_id LONG REFERENCES users(id) NOT NULL,
  friend_id LONG REFERENCES users(id) NOT NULL
);

CREATE TABLE IF NOT EXISTS likes (
  film_id long REFERENCES films(id) NOT NULL,
  user_id long REFERENCES users(id) NOT NULL
);